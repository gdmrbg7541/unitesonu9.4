<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> ØªÙ…Ø±ÙŠÙ† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¬Ù…Ù„</title>
    <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
       
    /* 1. ARAKOM.TTF dosyasÄ±nÄ± sisteme tanÄ±tÄ±yoruz */
    @font-face {
        font-family: 'Arakom';
        /* TarayÄ±cÄ± sÄ±rayla dener: Ã–nce hepsi bÃ¼yÃ¼k, sonra hepsi kÃ¼Ã§Ã¼k, sonra baÅŸ harfi bÃ¼yÃ¼k */
        src: url('ARAKOM.TTF') format('truetype'),
             url('arakom.ttf') format('truetype'),
             url('Arakom.ttf') format('truetype');
        font-weight: normal;
        font-style: normal;
    }

    /* 2. DeÄŸiÅŸkenleri ve Fontu Zorluyoruz */
    :root {
        --accent-color: #007bff;
        --success-color: #28a745;
        --danger-color: #dc3545;
        --bg-light: #f8f9fa;
        
        /* Fontu 'Arakom' olarak gÃ¼ncelledik */
        --font-arabic: 'Arakom', 'Markazi Text', 'Noto Naskh Arabic', 'Tahoma', 'Arial', sans-serif;
    }

    /* 3. Ã–NEMLÄ°: Body ve TÃœM BUTONLAR iÃ§in fontu zorluyoruz */
    body, button, .word-item {
        font-family: var(--font-arabic) !important; /* !important ile baskÄ±n kÄ±ldÄ±k */
    }
        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            
        }

        /* --- CÄ°HAZ DÃ–NDÃœRME UYARISI --- */
        #rotate-message {
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #2c3e50; 
            z-index: 9999; 
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }

        .phone-animation {
            width: 60px;
            height: 100px;
            border: 4px solid white;
            border-radius: 10px;
            animation: rotate-phone 2s infinite ease-in-out;
            margin-bottom: 20px;
            position: relative;
        }
        .phone-animation::before {
            content: '';
            position: absolute;
            top: 10px; left: 50%;
            transform: translateX(-50%);
            width: 20%; height: 4px;
            background: white;
            border-radius: 2px;
        }
        @keyframes rotate-phone {
            0% { transform: rotate(0deg); opacity: 1; }
            25% { transform: rotate(90deg); opacity: 1; }
            70% { transform: rotate(90deg); opacity: 1; }
            100% { transform: rotate(90deg); opacity: 0; }
        }
        .rotate-text { font-size: 2rem; font-family: var(--font-arabic); }

        @media only screen and (max-width: 900px) and (orientation: portrait) {
            #rotate-message { display: flex; }
            .activity-container { display: none; } 
        }

     /* Bu sadeleÅŸtirilmiÅŸ versiyonu kullanmanÄ±z Ã¶nerilir: */
.activity-container {
    position: relative;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    
    /* GENÄ°ÅLÄ°K: EkranÄ±n %98'i, fakat maksimum %98vh'ye gÃ¶re 16:9 oranÄ±nÄ± geÃ§emez. */
    width: 98vw; 
    max-width: calc(98vh * 16 / 9); 
    
    /* YÃœKSEKLÄ°K: GeniÅŸliÄŸe gÃ¶re 16:9 oranÄ±, fakat maksimum %98vh'yi geÃ§emez. */
    height: calc(98vw * 9 / 16); 
    max-height: 98vh;
}
        
        /* --- Header --- */
        .back-button-container {
            grid-area: back;
            display: flex;
            justify-content: flex-end; 
            align-items: center; 
        }
        .back-button, #fullscreen-btn {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0; 
        }
        .back-button { text-decoration: none; }
        #fullscreen-btn { margin-left: 10px; }
        .back-button:hover, #fullscreen-btn:hover { background: #e0e0e0; }
        .back-button svg, #fullscreen-btn svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }
        
        #fullscreen-btn .icon-open { display: block; }
        #fullscreen-btn .icon-close { display: none; }
        body.fullscreen #fullscreen-btn .icon-open { display: none; }
        body.fullscreen #fullscreen-btn .icon-close { display: block; }

        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "progress instruction back"; 
            grid-template-columns: 200px 1fr 200px;
            align-items: center;
            gap: 20px;
        }
        
        #instruction-text { 
            grid-area: instruction;
            text-align: center; 
            font-size: 2.2rem; 
            font-weight: 700;
            color: #555;
            font-family: var(--font-arabic);
        }
        
        .progress-container { 
            grid-area: progress;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: flex-start;
            width: 200px;
            direction: ltr; 
        }
        #progress-display {
            font-size: 1.5rem; 
            font-weight: bold;
            color: var(--accent-color);
            flex-shrink: 0;
        }
        .progress-bar-container {
            flex-grow: 1;
            height: 12px;
            background-color: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        #progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--accent-color);
            transition: width 0.4s ease, background-color 0.4s ease;
        }

        /* --- Etkinlik AlanÄ± --- */
        .activity-area {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow-y: auto;
            position: relative;
        }

        .scramble-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .drop-zone, .drag-zone {
            border: 2px dashed #d0d0d0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-height: 120px;
            background: var(--bg-light);
            display: flex;
            flex-wrap: wrap;
            align-content: center; 
            flex-grow: 1; 
            transition: background-color 0.3s, border-color 0.3s; 
            gap: 10px; /* Kelimeler arasÄ±na modern boÅŸluk */
        }
        .drop-zone {
            border-style: solid;
            border-color: var(--accent-color);
            font-size: 2.5rem; 
            justify-content: center;
        }
        .drag-zone { justify-content: center; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }
        .drop-zone-correct {
            border-color: var(--success-color);
            background-color: #f0f9f2; 
        }
        .drop-zone-incorrect {
            border-color: var(--danger-color);
            background-color: #fcf2f2; 
            animation: shake 0.4s ease-in-out;
        }
        
       .word-item {
    /* Ä°Ã‡ERÄ°K DÃœZENÄ° */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    
    /* YAZI TÄ°PÄ° AYARLARI */
    color: white;
    font-size: clamp(2.0rem, 3.5vw, 3.0rem);
    font-weight: 700;
    
    /* KRÄ°TÄ°K AYAR: Harf Kesilmesini Ã–nleyen KÄ±sÄ±m */
    line-height: 2.5; /* SatÄ±r yÃ¼ksekliÄŸini artÄ±rdÄ±k (Hemzeler iÃ§in yer aÃ§ar) */
    padding: 8px 16px; /* Kutunun iÃ§indeki boÅŸluk */
    
    /* KUTU GÃ–RÃœNÃœMÃœ */
    margin: 8px; /* Kutular arasÄ± mesafe */
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    
    /* ETKÄ°LEÅÄ°M */
    cursor: grab; 
    user-select: none;
    transform-origin: center center;
    
    /* GÃ¼venlik: TaÅŸmalarÄ± gizleme, gÃ¶ster */
    overflow: visible; 
    height: auto; /* Sabit yÃ¼kseklik olmasÄ±n, yazÄ±ya gÃ¶re uzasÄ±n */
}
        .word-item[draggable="true"]:active { cursor: grabbing; }
        .word-item[draggable="false"] { cursor: default; }
        .word-item:hover { filter: brightness(85%); }
        .word-item.dragging { opacity: 0.5; cursor: grabbing; }
        
       /* --- Butonlar (GÃœNCELLENMÄ°Å) --- */
        #check-scramble-btn, #reset-scramble-btn, #next-activity-btn {
            /* Ortak Ã¶zellikler */
            font-size: 2rem; 
            font-family: var(--font-arabic);
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, opacity 0.2s;
            margin: 5px;
            display: flex; 
            align-items: center;
            justify-content: center;
            
            /* Dikey hizalama garantisi iÃ§in satÄ±r yÃ¼ksekliÄŸini sÄ±fÄ±rlÄ±yoruz */
            line-height: normal; 
        }

        /* ONAY ve YENÄ°LE ButonlarÄ± iÃ§in SABÄ°T BOYUT AYARI */
        #check-scramble-btn, #reset-scramble-btn {
            width: 200px;  /* Ä°kisi de aynÄ± geniÅŸlik */
            height: 70px;  /* Ä°kisi de aynÄ± yÃ¼kseklik */
            padding: 0;    /* Ä°Ã§ boÅŸluÄŸu sÄ±fÄ±rladÄ±k ki taÅŸma yapmasÄ±n */
        }

        /* Renkler */
        #check-scramble-btn { background-color: var(--success-color); color: white; }
        #reset-scramble-btn { background-color: var(--danger-color); color: white; }

        /* Sonraki Etkinlik Butonu (Yuvarlak kalmaya devam etsin) */
        #next-activity-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 0; 
            width: clamp(55px, 10vmin, 70px); 
            height: clamp(55px, 10vmin, 70px);
            border-radius: 50%; 
        }
        
        #next-activity-btn svg {
            width: clamp(30px, 6vmin, 40px);
            height: clamp(30px, 6vmin, 40px);
            fill: currentColor;
        }
        /* Pasif Buton Stili */
        .disabled-btn {
            opacity: 0.4; 
            cursor: not-allowed !important;
            pointer-events: none; 
            filter: grayscale(100%); 
        }

        /* --- Ä°PUCU (AMPUL) BUTONU --- */
        #hint-btn {
            background-color: #ffc107; 
            color: #333;
            border: none;
            border-radius: 50%;
            width: clamp(55px, 10vmin, 70px); 
            height: clamp(55px, 10vmin, 70px);
            font-size: 1.1rem; 
            cursor: pointer;
            
            /* KESÄ°N POZÄ°SYONLAMA: Konteynerin SAÄ tarafÄ±na sabitle */
            position: absolute; 
            right: 20px; /* SaÄŸdan 20px boÅŸluk */
            top: 50%; /* Dikeyde ortala */
            transform: translateY(-50%);
            
            display: flex; 
            visibility: hidden; 
            
            align-items: center;
            justify-content: center;
            margin: 0; /* Margin sÄ±fÄ±rlandÄ± Ã§Ã¼nkÃ¼ absolute kullanÄ±yoruz */
            box-shadow: 0 4px 10px rgba(255, 193, 7, 0.4);
            animation: pulse 1.5s infinite;
            z-index: 10; /* ButonlarÄ±n Ã¼stÃ¼nde kalsÄ±n gerekirse */
        }
        @keyframes pulse {
            0% { transform: translateY(-50%) scale(1); box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.7); }
            70% { transform: translateY(-50%) scale(1.1); box-shadow: 0 0 0 10px rgba(255, 193, 7, 0); }
            100% { transform: translateY(-50%) scale(1); box-shadow: 0 0 0 0 rgba(255, 193, 7, 0); }
        }

        /* GÃœNCELLENMÄ°Å KONTROL ALANI */
        .scramble-controls {
            position: relative; /* Absolute konumlanan ampul iÃ§in referans noktasÄ± */
            display: flex;
            justify-content: center; /* Ä°Ã§erikleri ORTALA */
            align-items: center; 
            margin-top: 15px;
            flex-shrink: 0;
            min-height: 80px; 
            width: 100%; /* Tam geniÅŸlik */
        }
        
        #finish-screen {
            text-align: center;
            font-weight: 700;
            color: var(--accent-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-family: var(--font-arabic);
        }
        #finish-screen p { font-size: 3.5rem; margin: 10px 0; }
        .score-display {
            display: flex;
            gap: 30px;
            font-size: 2.8rem; 
            margin: 20px 0;
            direction: ltr;
        }
        .score-item { font-weight: 700; }
        .score-correct { color: var(--success-color); }
        .score-incorrect { color: var(--danger-color); }

        #replay-button {
            font-size: 4.5rem; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
            font-family: var(--font-arabic);
        }
        #replay-button:hover { transform: rotate(-90deg); background-color: #f0f0f0; }
        
        /* --- Mobil DÃ¼zen --- */
        @media (orientation: portrait) {
            /* Dikeyde zaten gizli */
        }
/* --- MOBÄ°L YATAY: SABÄ°T ORAN KALDIRILMIÅ VE SIKIÅTIRILMIÅ DÃœZEN --- */
@media only screen and (max-height: 500px) and (orientation: landscape) {
    
    /* 1. Ana Konteyner: 16:9 oranÄ±nÄ± iptal edip tam ekran yapÄ±yoruz */
    .activity-container {
        width: 100vw !important;  /* Ekran geniÅŸliÄŸinin tamamÄ± */
        height: 100vh !important; /* Ekran yÃ¼ksekliÄŸinin tamamÄ± */
        max-width: none !important;
        max-height: none !important;
        aspect-ratio: auto !important; /* Varsa oran zorunluluÄŸunu kaldÄ±rÄ±r */
        border-radius: 0 !important;
        display: flex !important;
        flex-direction: column !important;
    }

    /* 2. Oyun AlanÄ±: Ä°Ã§indeki boÅŸluklarÄ± (flex-grow) yÃ¶netiyoruz */
    #activity-area {
        flex: 1 !important; /* Kalan tÃ¼m alanÄ± doldur */
        display: flex !important;
        flex-direction: column !important;
        justify-content: center !important; /* KutularÄ± dikeyde merkeze toplar */
        gap: 5px !important; /* Kutular arasÄ± boÅŸluk */
        padding: 5px 10px !important;
    }

    /* 3. Kutular: Kesinlikle kelime yÃ¼ksekliÄŸinde olacak */
    .drop-zone, .drag-zone {
        flex: 0 0 auto !important;   /* Kendi baÅŸÄ±na bÃ¼yÃ¼mesini engelle */
        height: 55px !important;     /* Sabit yÃ¼kseklik (Kelime + 5-7px) */
        min-height: 42px !important;
        padding: 10px 5px !important;
        margin: 10px 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        overflow: hidden !important;
    }

    /* 4. Kelimeler: Gereksiz boÅŸluklar atÄ±ldÄ± */
    .word-item {
        height: 34px !important;      /* Kelime butonunun net yÃ¼ksekliÄŸi */
        font-size: 2.0rem !important;
        padding: 5px 5px !important;
        margin: 5px !important;
        line-height: 34px !important; /* YazÄ±yÄ± dikey ortala */
        display: inline-flex !important;
        align-items: center !important;
    }

    /* 5. Ãœst Bar (Header): Ä°nce ÅŸerit hali */
    .header {
        height: 60px !important;
        min-height: 35px !important;
        padding: 0 15px !important;
    }

    #instruction-text {
        font-size: 1.6rem !important;
    }
.answer-input {
        width: 300px; /* GeniÅŸliÄŸi biraz daha artÄ±rdÄ±k */
        height: 50px !important; /* YÃ¼ksekliÄŸi hemzenin sÄ±ÄŸacaÄŸÄ± bir seviyeye Ã§ektik */
        line-height: 1 !important; /* Harfin dikeyde kesilmesini Ã¶nler */
        padding: 5px 10px;
        font-size: clamp(1.4rem, 2.8vw, 2.5rem); /* Fontu Ã§ok az kÃ¼Ã§Ã¼lterek alandan kazandÄ±k */
        display: inline-flex;
        align-items: center; 
        justify-content: center;
        overflow: visible; /* Hemzenin kutu dÄ±ÅŸÄ±na taÅŸsa bile gÃ¶rÃ¼nmesini saÄŸlar */
       text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    padding-top: 10px;
    }

    /* 6. Alt Butonlar: KÃ¼Ã§Ã¼k ve kompakt */
    .scramble-controls {
        height: 40px !important;
        min-height: 40px !important;
        padding: 15px !important;
        margin: 5px !important;
    }

    #check-scramble-btn, #reset-scramble-btn {
        height: 40px !important;
        width: 110px !important;
        font-size: 1.5rem !important;
    }
}
    </style>
</head>
<body>
<audio id="intro-sound" src="yonergesirala.wav"></audio>

    <div id="rotate-message">
        <div class="phone-animation"></div>
        <div class="rotate-text">ÙŠÙØ±Ø¬Ù‰ ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¬Ù‡Ø§Ø²</div> 
    </div>

    <div class="activity-container">
        
        <div class="header" id="game-header" style="display: none;">
            <div class="progress-container">
                <div id="progress-display">...</div> 
                <div class="progress-bar-container">
                    <div id="progress-bar"></div>
                </div>
            </div>
            
            <div id="instruction-text">...</div>

            <div class="back-button-container">
                <button id="fullscreen-btn">
                    <svg class="icon-open" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 10h2V7h3V5H5v5zM14 5v2h3v3h2V5h-5zM5 19v-5h2v3h3v2H5zM14 19v-2h3v-3h2v5h-5z"/>
                    </svg>
                    <svg class="icon-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
                    </svg>
                </button>
                
                <a href="index.html" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </a>
            </div>
        </div>

       <div class="activity-container">
        <div class="activity-area" id="activity-area">
            <div id="start-screen" style="
                text-align: center;
                font-family: var(--font-arabic);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                height: 100%;
                background: #fcfcfc;
                padding: 20px;
                box-sizing: border-box;
            ">
                
                <button id="start-button" style="
                    font-size: 3rem;
                    padding: 15px 40px;
                    border: none;
                    border-radius: 10px;
                    cursor: pointer;
                    background-color: var(--success-color);
                    color: white;
                    font-weight: 700;
                    box-shadow: 0 4px 10px rgba(40, 167, 69, 0.4);
                    transition: transform 0.2s;
                    font-family: inherit;
                ">
                    Ø¥ÙØ¨Ù’Ø¯ÙØ£Ù’
                </button>
            </div>
            </div>
    </div>

    </div>

    <script>
         // --- ETKÄ°NLÄ°K VERÄ°LERÄ° ---
const activitiesData = [
    // 1. GÃœNLÃœK AKTÄ°VÄ°TE SORUSU
    {
        "s": [
            "Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ Ø§Ù„ÙŠÙÙˆÙ’Ù… ÙŠØ§ Ø­ÙØ³ÙÙ† ØŸ",
            "ÙŠØ§ Ø­ÙØ³ÙÙ† Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ Ø§Ù„ÙŠÙÙˆÙ’Ù… ØŸ",
            "Ø§Ù„ÙŠÙÙˆÙ’Ù… Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ÙŠØ§ Ø­ÙØ³ÙÙ† ØŸ",
            "Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ÙŠØ§ Ø­ÙØ³ÙÙ† Ø§Ù„ÙŠÙÙˆÙ’Ù… ØŸ",
            "ÙŠØ§ Ø­ÙØ³ÙÙ† Ø§Ù„ÙŠÙÙˆÙ’Ù… Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ØŸ"
        ],
        "w": ["Ù…Ø§Ø°Ø§", "ÙÙØ¹ÙÙ„Ù’ØªÙ", "Ø§Ù„ÙŠÙÙˆÙ’Ù…", "ÙŠØ§", "Ø­ÙØ³ÙÙ†", "ØŸ"]
    },

    // 2. UYANMA
    {
        "s": [
            "Ø§Ø³Ù’ØªÙÙŠÙ’Ù‚ÙØ¸Ù’ØªÙ Ù…ÙÙ† Ø§Ù„Ù†ÙÙ‘ÙˆÙ’Ù… Ù…ÙØ¨ÙÙƒÙÙ‘Ø±Ù‹Ø§",
            "Ù…ÙØ¨ÙÙƒÙÙ‘Ø±Ù‹Ø§ Ø§Ø³Ù’ØªÙÙŠÙ’Ù‚ÙØ¸Ù’ØªÙ Ù…ÙÙ† Ø§Ù„Ù†ÙÙ‘ÙˆÙ’Ù…"
        ],
        "w": ["Ø§Ø³Ù’ØªÙÙŠÙ’Ù‚ÙØ¸Ù’ØªÙ", "Ù…ÙÙ†", "Ø§Ù„Ù†ÙÙ‘ÙˆÙ’Ù…", "Ù…ÙØ¨ÙÙƒÙÙ‘Ø±Ù‹Ø§"]
    },

    // 3. NAMAZ (MantÄ±k hatasÄ± giderildi, sadece doÄŸru sÄ±ralama bÄ±rakÄ±ldÄ±)
    {
        "s": [
            "ØªÙÙˆÙØ¶ÙÙ‘Ø£Ù’ØªÙ ÙˆÙØµÙÙ„ÙÙ‘ÙŠÙ’ØªÙ Ø§Ù„ÙÙØ¬Ù’Ø±"
        ],
        "w": ["ØªÙÙˆÙØ¶ÙÙ‘Ø£Ù’ØªÙ", "ÙˆÙØµÙÙ„ÙÙ‘ÙŠÙ’ØªÙ", "Ø§Ù„ÙÙØ¬Ù’Ø±"]
    },

    // 4. KAHVALTI
    {
        "s": [
            "ØªÙÙ†Ø§ÙˆÙÙ„Ù’ØªÙ Ø§Ù„ÙÙØ·ÙˆØ± ÙÙŠ Ø§Ù„ØµÙÙ‘Ø¨Ø§Ø­",
            "ÙÙŠ Ø§Ù„ØµÙÙ‘Ø¨Ø§Ø­ ØªÙÙ†Ø§ÙˆÙÙ„Ù’ØªÙ Ø§Ù„ÙÙØ·ÙˆØ±"
        ],
        "w": ["ØªÙÙ†Ø§ÙˆÙÙ„Ù’ØªÙ", "Ø§Ù„ÙÙØ·ÙˆØ±", "ÙÙŠ", "Ø§Ù„ØµÙÙ‘Ø¨Ø§Ø­"]
    },

    // 5. OTOBÃœS VE OKUL
    {
        "s": [
            "Ø°ÙÙ‡ÙØ¨Ù’ØªÙ Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ© Ø¨ÙØ§Ù„Ø­Ø§ÙÙÙ„ÙØ©",
            "Ø¨ÙØ§Ù„Ø­Ø§ÙÙÙ„ÙØ© Ø°ÙÙ‡ÙØ¨Ù’ØªÙ Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©" // Sondaki hareke tutarlÄ±lÄ±ÄŸÄ± iÃ§in 'i' harekesini kaldÄ±rdÄ±m, kelime listesinde yoksa eÅŸleÅŸmez.
        ],
        "w": ["Ø°ÙÙ‡ÙØ¨Ù’ØªÙ", "Ø¥ÙÙ„Ù‰", "Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©", "Ø¨ÙØ§Ù„Ø­Ø§ÙÙÙ„ÙØ©"]
    },

    // 6. SAAT SORMA (Ã‡ift boÅŸluk dÃ¼zeltildi)
    {
        "s": [
            "ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¢Ù† ÙŠØ§ Ø£ÙØ®ÙŠ ØŸ",
            "ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© ÙŠØ§ Ø£ÙØ®ÙŠ Ø§Ù„Ø¢Ù† ØŸ", // Soru iÅŸareti Ã¶ncesi boÅŸluk standardÄ±
            "Ø§Ù„Ø¢Ù† ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© ÙŠØ§ Ø£ÙØ®ÙŠ ØŸ",
            "Ø§Ù„Ø¢Ù† ÙŠØ§ Ø£ÙØ®ÙŠ ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© ØŸ",
            "ÙŠØ§ Ø£ÙØ®ÙŠ ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¢Ù† ØŸ",
            "ÙŠØ§ Ø£ÙØ®ÙŠ Ø§Ù„Ø¢Ù† ÙƒÙÙ… Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© ØŸ"
        ],
        "w": ["ÙƒÙÙ…", "Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ©", "Ø§Ù„Ø¢Ù†", "ÙŠØ§", "Ø£ÙØ®ÙŠ", "ØŸ"]
    },

    // 7. SAAT ON BUÃ‡UK
    {
        "s": [
            "Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¢Ù† Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ© ÙˆÙØ§Ù„Ù†ÙÙ‘ØµÙ’Ù",
            "Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ© ÙˆÙØ§Ù„Ù†ÙÙ‘ØµÙ’Ù Ø§Ù„Ø¢Ù†",
            "Ø§Ù„Ø¢Ù† Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ© ÙˆÙØ§Ù„Ù†ÙÙ‘ØµÙ’Ù"
        ],
        "w": ["Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ©", "Ø§Ù„Ø¢Ù†", "Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ©", "ÙˆÙØ§Ù„Ù†ÙÙ‘ØµÙ’Ù"]
    },

    // 8. ARAPÃ‡A DERSÄ°
    {
        "s": [
            "Ø¯ÙØ±ÙØ³Ù’ØªÙ Ø§Ù„Ù„ÙÙ‘ØºÙØ© Ø§Ù„Ø¹ÙØ±ÙØ¨ÙÙŠÙÙ‘Ø© Ø§Ù„ÙŠÙÙˆÙ’Ù…",
            "Ø§Ù„ÙŠÙÙˆÙ’Ù… Ø¯ÙØ±ÙØ³Ù’ØªÙ Ø§Ù„Ù„ÙÙ‘ØºÙØ© Ø§Ù„Ø¹ÙØ±ÙØ¨ÙÙŠÙÙ‘Ø©"
        ],
        "w": ["Ø¯ÙØ±ÙØ³Ù’ØªÙ", "Ø§Ù„Ù„ÙÙ‘ØºÙØ©", "Ø§Ù„Ø¹ÙØ±ÙØ¨ÙÙŠÙÙ‘Ø©", "Ø§Ù„ÙŠÙÙˆÙ’Ù…"]
    },

    // 9. YEMEK TERCÄ°HÄ°
    {
        "s": [
            "Ø£ÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ø¯ÙÙ‘Ø¬Ø§Ø¬ Ù…ÙØ¹ Ø§Ù„Ø£ÙØ±ÙØ²Ù‘",
            "Ø£ÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ø£ÙØ±ÙØ²Ù‘ Ù…ÙØ¹ Ø§Ù„Ø¯ÙÙ‘Ø¬Ø§Ø¬",
            "Ù…ÙØ¹ Ø§Ù„Ø£ÙØ±ÙØ²Ù‘ Ø£ÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ø¯ÙÙ‘Ø¬Ø§Ø¬",
            "Ù…ÙØ¹ Ø§Ù„Ø¯ÙÙ‘Ø¬Ø§Ø¬ Ø£ÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ø£ÙØ±ÙØ²Ù‘"
        ],
        "w": ["Ø£ÙØ­ÙØ¨ÙÙ‘", "Ø§Ù„Ø¯ÙÙ‘Ø¬Ø§Ø¬", "Ù…ÙØ¹", "Ø§Ù„Ø£ÙØ±ÙØ²Ù‘"]
    },

    // 10. Ä°Ã‡ECEK SORUSU
    {
        "s": [
            "Ù…Ø§Ø°Ø§ ØªÙØ´Ù’Ø±ÙØ¨Ù ÙŠØ§ ØµÙØ¯ÙŠÙ‚ÙŠ ØŸ",
            "ÙŠØ§ ØµÙØ¯ÙŠÙ‚ÙŠ Ù…Ø§Ø°Ø§ ØªÙØ´Ù’Ø±ÙØ¨Ù ØŸ"
        ],
        "w": ["Ù…Ø§Ø°Ø§", "ØªÙØ´Ù’Ø±ÙØ¨Ù", "ÙŠØ§", "ØµÙØ¯ÙŠÙ‚ÙŠ", "ØŸ"]
    },

    // 11. MEYVE SUYU
    {
        "s": [
            "Ø£ÙØ´Ù’Ø±ÙØ¨Ù Ø¹ÙØµÙŠØ± Ø§Ù„Ø¨ÙØ±Ù’ØªÙÙ‚Ø§Ù„ Ø§Ù„Ø¢Ù†",
            "Ø§Ù„Ø¢Ù† Ø£ÙØ´Ù’Ø±ÙØ¨Ù Ø¹ÙØµÙŠØ± Ø§Ù„Ø¨ÙØ±Ù’ØªÙÙ‚Ø§Ù„"
        ],
        "w": ["Ø£ÙØ´Ù’Ø±ÙØ¨Ù", "Ø¹ÙØµÙŠØ±", "Ø§Ù„Ø¨ÙØ±Ù’ØªÙÙ‚Ø§Ù„", "Ø§Ù„Ø¢Ù†"]
    },

    // 12. AÃ‡LIK DURUMU
    {
        "s": [
            "Ø£Ù†Ø§ Ø¬ÙÙˆÙ’Ø¹Ø§Ù† Ø¬ÙØ¯Ù‹Ù‘Ø§ ÙŠØ§ Ø£ÙÙ…Ù‘ÙŠ",
            "ÙŠØ§ Ø£ÙÙ…Ù‘ÙŠ Ø£Ù†Ø§ Ø¬ÙÙˆÙ’Ø¹Ø§Ù† Ø¬ÙØ¯Ù‹Ù‘Ø§"
        ],
        "w": ["Ø£Ù†Ø§", "Ø¬ÙÙˆÙ’Ø¹Ø§Ù†", "Ø¬ÙØ¯Ù‹Ù‘Ø§", "ÙŠØ§", "Ø£ÙÙ…Ù‘ÙŠ"]
    },

    // 13. TOKLUK VE ÅÃœKÃœR
    {
        "s": [
            "Ø£ÙÙ†Ø§ Ø´ÙØ¨Ù’Ø¹Ø§Ù† Ø§Ù„Ø­ÙÙ…Ù’Ø¯ Ù„ÙÙ„Ù‘Ù°Ù‡Ù",
            "Ø§Ù„Ø­ÙÙ…Ù’Ø¯ Ù„ÙÙ„Ù‘Ù°Ù‡Ù Ø£ÙÙ†Ø§ Ø´ÙØ¨Ù’Ø¹Ø§Ù†"
        ],
        "w": ["Ø£ÙÙ†Ø§", "Ø´ÙØ¨Ù’Ø¹Ø§Ù†", "Ø§Ù„Ø­ÙÙ…Ù’Ø¯", "Ù„ÙÙ„Ù‘Ù°Ù‡Ù"]
    },

    // 14. EVE DÃ–NÃœÅ
    {
        "s": [
            "Ø±ÙØ¬ÙØ¹Ù’ØªÙ Ø¥ÙÙ„Ù‰ Ø§Ù„Ø¨ÙÙŠÙ’Øª Ù…ÙØ³Ø§Ø¡Ù‹",
            "Ù…ÙØ³Ø§Ø¡Ù‹ Ø±ÙØ¬ÙØ¹Ù’ØªÙ Ø¥ÙÙ„Ù‰ Ø§Ù„Ø¨ÙÙŠÙ’Øª"
        ],
        "w": ["Ø±ÙØ¬ÙØ¹Ù’ØªÙ", "Ø¥ÙÙ„Ù‰", "Ø§Ù„Ø¨ÙÙŠÙ’Øª", "Ù…ÙØ³Ø§Ø¡Ù‹"]
    },

    // 15. Ã–DEV YAPMA
    {
        "s": [
            "ÙƒÙØªÙØ¨Ù’ØªÙ Ø§Ù„ÙˆØ§Ø¬ÙØ¨Ø§Øª ÙÙŠ Ø§Ù„ØºÙØ±Ù’ÙÙØ©",
            "ÙÙŠ Ø§Ù„ØºÙØ±Ù’ÙÙØ© ÙƒÙØªÙØ¨Ù’ØªÙ Ø§Ù„ÙˆØ§Ø¬ÙØ¨Ø§Øª"
        ],
        "w": ["ÙƒÙØªÙØ¨Ù’ØªÙ", "Ø§Ù„ÙˆØ§Ø¬ÙØ¨Ø§Øª", "ÙÙŠ", "Ø§Ù„ØºÙØ±Ù’ÙÙØ©"]
    },

    // 16. KUR'AN OKUMAK
    {
        "s": [
            "Ù‚ÙØ±ÙØ£Ù’ØªÙ Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù† Ø§Ù„ÙƒÙØ±ÙŠÙ… Ø¨ÙØ¹Ù’Ø¯ Ø§Ù„Ø¹ÙØµÙ’Ø±",
            "Ø¨ÙØ¹Ù’Ø¯ Ø§Ù„Ø¹ÙØµÙ’Ø± Ù‚ÙØ±ÙØ£Ù’ØªÙ Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù† Ø§Ù„ÙƒÙØ±ÙŠÙ…"
        ],
        "w": ["Ù‚ÙØ±ÙØ£Ù’ØªÙ", "Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù†", "Ø§Ù„ÙƒÙØ±ÙŠÙ…", "Ø¨ÙØ¹Ù’Ø¯", "Ø§Ù„Ø¹ÙØµÙ’Ø±"]
    },

    // 17. MAZÄ° FÄ°Ä°L (O GÄ°TTÄ°)
    {
        "s": [
            "Ø¹Ø§ØµÙÙ… Ø°ÙÙ‡ÙØ¨Ù Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©",
            "Ø°ÙÙ‡ÙØ¨Ù Ø¹Ø§ØµÙÙ… Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©"
        ],
        "w": ["Ø¹Ø§ØµÙÙ…", "Ø°ÙÙ‡ÙØ¨Ù", "Ø¥ÙÙ„Ù‰", "Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©"]
    },

    // 18. MAZÄ° FÄ°Ä°L (O KIZ GÄ°TTÄ°)
    {
        "s": [
            "Ù…ÙØ±Ù’ÙˆÙØ© Ø°ÙÙ‡ÙØ¨ÙØªÙ’ Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙÙƒÙ’ØªÙØ¨ÙØ©",
            "Ø°ÙÙ‡ÙØ¨ÙØªÙ’ Ù…ÙØ±Ù’ÙˆÙØ© Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙÙƒÙ’ØªÙØ¨ÙØ©"
        ],
        "w": ["Ù…ÙØ±Ù’ÙˆÙØ©", "Ø°ÙÙ‡ÙØ¨ÙØªÙ’", "Ø¥ÙÙ„Ù‰", "Ø§Ù„Ù…ÙÙƒÙ’ØªÙØ¨ÙØ©"]
    },

    // 19. UYUMA VAKTÄ° (HAREKE DÃœZELTÄ°LDÄ°)
    {
        "s": [
            "Ù†ÙÙ…Ù’ØªÙ ÙÙŠ Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ© Ù„ÙÙŠÙ’Ù„Ø§Ù‹", // Åeddeli Sin dÃ¼zeltildi, 'w' ile aynÄ± yapÄ±ldÄ±
            "Ù„ÙÙŠÙ’Ù„Ø§Ù‹ Ù†ÙÙ…Ù’ØªÙ ÙÙŠ Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ© Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ©"
        ],
        "w": ["Ù†ÙÙ…Ù’ØªÙ", "ÙÙŠ", "Ø§Ù„Ø³Ù‘Ø§Ø¹ÙØ©", "Ø§Ù„Ø¹Ø§Ø´ÙØ±ÙØ©", "Ù„ÙÙŠÙ’Ù„Ø§Ù‹"]
    },

    // 20. GEÃ‡MÄ°Å ZAMAN (DÃœN)
    {
        "s": [
            "Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ Ø£ÙÙ…Ù’Ø³ ÙŠØ§ Ø¹ÙÙ„ÙŠ ØŸ",
            "ÙŠØ§ Ø¹ÙÙ„ÙŠ Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ Ø£ÙÙ…Ù’Ø³ ØŸ",
            "Ø£ÙÙ…Ù’Ø³ Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ÙŠØ§ Ø¹ÙÙ„ÙŠ ØŸ",
            "Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ÙŠØ§ Ø¹ÙÙ„ÙŠ Ø£ÙÙ…Ù’Ø³ ØŸ",
            "ÙŠØ§ Ø¹ÙÙ„ÙŠ Ø£ÙÙ…Ù’Ø³ Ù…Ø§Ø°Ø§ ÙÙØ¹ÙÙ„Ù’ØªÙ ØŸ"
        ],
        "w": ["Ù…Ø§Ø°Ø§", "ÙÙØ¹ÙÙ„Ù’ØªÙ", "Ø£ÙÙ…Ù’Ø³", "ÙŠØ§", "Ø¹ÙÙ„ÙŠ", "ØŸ"]
    }
];

        // --- Gerekli Elementler ---
        const activityArea = document.getElementById('activity-area');
        const instructionText = document.getElementById('instruction-text');
        const progressDisplay = document.getElementById('progress-display');
        const progressBar = document.getElementById('progress-bar');

        // --- Renk Paleti ---
        const colorPalette = ['#007bff', '#dc3545', '#28a745', '#ffc107', '#17a2b8', '#6f42c1', '#fd7e14'];

        let audioCtx = null;
        let activityQueue = [];
        let currentActivityIndex = 0;
        let grandTotalActivities = 0; 
        let scoreCorrect = 0;
        let scoreIncorrect = 0;
        let currentTour = 1; 
        
        // --- Tam Ekran ---
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => console.error(err));
            } else {
                if (document.exitFullscreen) document.exitFullscreen();
            }
        }

        // --- Ses ---
        function initAudioContext() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'touch') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(200, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            } else if (type === 'correct') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2); 
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') { 
                oscillator.type = 'square'; 
                oscillator.frequency.setValueAtTime(164.81, now); 
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2); 
                oscillator.start(now);
                oscillator.stop(now + 0.2); 
            }
        }
        
        document.body.addEventListener('click', initAudioContext, { once: true });

        // --- KarÄ±ÅŸtÄ±rÄ±cÄ± ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- OTOMATÄ°K SIRALAMA VE BÃ–LME ---
        function createActivityQueue() {
            const sortedByLength = [...activitiesData].sort((a, b) => a.w.length - b.w.length);
            const shortSentences = sortedByLength.slice(0, 10);
            const longSentences = sortedByLength.slice(10, 20);

            if (currentTour === 1) {
                console.log("Tur 1: KÄ±sa cÃ¼mleler yÃ¼kleniyor.");
                activityQueue = shuffle([...shortSentences]);
            } else {
                if (currentTour > 2) {
                    currentTour = 1;
                    console.log("BaÅŸa dÃ¶nÃ¼ldÃ¼ -> Tur 1");
                    activityQueue = shuffle([...shortSentences]);
                } else {
                    console.log("Tur 2: Uzun cÃ¼mleler yÃ¼kleniyor.");
                    activityQueue = shuffle([...longSentences]);
                }
            }
            
            grandTotalActivities = activityQueue.length;
            if (grandTotalActivities === 0) {
                 activityQueue = shuffle([...activitiesData]); 
                 grandTotalActivities = activityQueue.length;
            }
        }

        // --- Etkinlik YÃ¼kleyici ---
        function loadActivity() {
            activityArea.innerHTML = '';
            updateProgress();
            
            const activityData = activityQueue[currentActivityIndex]; 
            instructionText.textContent = "Ø±ÙØªÙÙ‘Ø¨ Ø§Ù„ÙƒÙÙ„ÙÙ…Ø§Øª Ù„ÙØªÙÙƒÙ’ÙˆÙŠÙ† Ø¬ÙÙ…Ù’Ù„ÙØ©â€«.â€¬";
            buildScramble(activityData);
        }
        
        // --- BUTON DURUMUNU KONTROL ET (GÃœNCELLENDÄ°) ---
        function updateButtonState() {
            const dragZone = document.getElementById('drag-zone');
            const dropZone = document.getElementById('drop-zone'); // BurayÄ± ekledik
            const checkBtn = document.getElementById('check-scramble-btn');
            const resetBtn = document.getElementById('reset-scramble-btn');

            if (!dragZone || !dropZone || !checkBtn || !resetBtn) return;

            // 1. Kural: DoÄŸrulama butonu sadece hepsi bitince aÃ§Ä±lsÄ±n
            const isAllMoved = dragZone.children.length === 0;
            if (isAllMoved) {
                checkBtn.classList.remove('disabled-btn');
            } else {
                checkBtn.classList.add('disabled-btn');
            }

            // 2. Kural: Yenile butonu en az 1 tane taÅŸÄ±nÄ±nca aÃ§Ä±lsÄ±n
            const isAnyMoved = dropZone.children.length > 0;
            if (isAnyMoved) {
                resetBtn.classList.remove('disabled-btn');
            } else {
                resetBtn.classList.add('disabled-btn');
            }
        }

        // --- TÄ±klayarak Kelime TaÅŸÄ±ma ---
        function handleWordClick(e) {
            const wordItem = e.currentTarget; 
            if (wordItem.draggable === false) return;
            const dropZone = document.getElementById('drop-zone');
            const dragZone = document.getElementById('drag-zone');
            
            if (wordItem.parentElement === dragZone) {
                dropZone.appendChild(wordItem);
            } else if (wordItem.parentElement === dropZone) {
                dragZone.appendChild(wordItem);
            }
            playSound('touch'); 
            
            updateButtonState();
        }

        // --- ArayÃ¼zÃ¼ OluÅŸtur ---
        function buildScramble(data) {
            const scrambleContainer = document.createElement('div');
            scrambleContainer.className = 'scramble-container';

            const dropZone = document.createElement('div');
            dropZone.id = 'drop-zone';
            dropZone.className = 'drop-zone';

            const dragZone = document.createElement('div');
            dragZone.id = 'drag-zone';
            dragZone.className = 'drag-zone';

            const correctOrderWords = data.s[0].split(' ');
            let wordObjects = correctOrderWords.map((wordText, index) => {
                return {
                    text: wordText,
                    color: colorPalette[index % colorPalette.length], 
                    id: `word-obj-${index}` 
                };
            });

            const shuffledObjects = shuffle([...wordObjects]);

            shuffledObjects.forEach((obj) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.textContent = obj.text;
                wordItem.id = obj.id; 
                wordItem.draggable = true;
                wordItem.style.backgroundColor = obj.color; 
                wordItem.addEventListener('click', handleWordClick);
                dragZone.appendChild(wordItem);
            });

            const controls = document.createElement('div');
            controls.className = 'scramble-controls';
            
            const checkButton = document.createElement('button');
            checkButton.id = 'check-scramble-btn';
            checkButton.textContent = 'âœ” ØªÙØ­ÙÙ‚ÙÙ‘Ù‚Ù’';
            checkButton.classList.add('disabled-btn');
            checkButton.onclick = () => {
                playSound('touch');
                checkScrambleAnswer(data.s); 
            };
            
            const resetButton = document.createElement('button');
            resetButton.id = 'reset-scramble-btn';
            resetButton.textContent = 'ğŸ”„ Ø¥ÙØ¹Ø§Ø¯ÙØ©';
            resetButton.classList.add('disabled-btn'); 
            resetButton.onclick = () => {
                playSound('touch');
                document.getElementById('hint-btn').style.visibility = 'hidden'; 
                loadActivity(); 
            };

            // --- Ä°PUCU (AMPUL) ---
            const hintButton = document.createElement('button');
            hintButton.id = 'hint-btn';
            hintButton.textContent = 'ğŸ’¡'; 
            hintButton.onclick = () => {
                playSound('touch');
                solvePuzzleAnimation(data.s[0]); 
            };
            
            const nextButton = document.createElement('button');
            nextButton.id = 'next-activity-btn';
            nextButton.style.display = 'none'; 
            nextButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11h12.17l-5.59-5.59L12 4l8 8-8 8-1.41-1.41L16.17 13H4v-2z"/></svg>`; 
            nextButton.onclick = () => {
                playSound('touch');
                nextActivity();
            };

            // DÃœZEN: Ampul absolute ile saÄŸa sabitlendi, diÄŸerleri merkezde normal akÄ±ÅŸta
            controls.appendChild(hintButton); // En saÄŸa (absolute ile)
            controls.appendChild(checkButton);
            controls.appendChild(resetButton);
            controls.appendChild(nextButton); 
            
            scrambleContainer.appendChild(dropZone);
            scrambleContainer.appendChild(dragZone);
            scrambleContainer.appendChild(controls);
            
            activityArea.appendChild(scrambleContainer);

            addDragDropListeners();
        }
        
        function toggleWordDrag(enable) {
            document.querySelectorAll('.word-item').forEach(item => {
                item.draggable = enable;
                item.style.cursor = enable ? 'grab' : 'default'; 
                if (!enable) item.classList.remove('dragging'); 
            });
        }

        // --- CEVAP KONTROLÃœ ---
        function checkScrambleAnswer(correctAnswers) {
            const dropZone = document.getElementById('drop-zone');
            const words = Array.from(dropZone.children).map(item => item.textContent);
            const userAnswer = words.join(' ');
            
            const cleanUserAnswer = userAnswer.replace(/\.$/, '');
            const cleanCorrectAnswers = correctAnswers.map(s => s.replace(/\.$/, ''));
            const isCorrect = cleanCorrectAnswers.includes(cleanUserAnswer);
            
            dropZone.classList.remove('drop-zone-correct', 'drop-zone-incorrect');
            
            if (isCorrect) {
                scoreCorrect++;
                playSound('correct'); 
                dropZone.classList.add('drop-zone-correct'); 
                
                document.getElementById('check-scramble-btn').style.display = 'none';
                document.getElementById('reset-scramble-btn').style.display = 'none';
                
                const hintBtn = document.getElementById('hint-btn');
                if(hintBtn) hintBtn.style.visibility = 'hidden';

                document.getElementById('next-activity-btn').style.display = 'flex';
                
                toggleWordDrag(false); 
                
            } else {
                scoreIncorrect++;
                playSound('incorrect'); 
                dropZone.classList.add('drop-zone-incorrect');
                
                const hintBtn = document.getElementById('hint-btn');
                if (hintBtn) hintBtn.style.visibility = 'visible';
                
                setTimeout(() => {
                const introAudio = document.getElementById('intro-sound');
                if(introAudio) {
                    introAudio.play().catch(e => console.log("Ses hatasÄ±:", e));
                }
            }, 2000);
            }
        }

        // --- SÄ°HÄ°RLÄ° ANÄ°MASYON (FLIP TEKNÄ°ÄÄ°) ---
        function solvePuzzleAnimation(correctSentenceStr) {
            const dropZone = document.getElementById('drop-zone');
            const allCards = Array.from(document.querySelectorAll('.word-item'));
            const hintBtn = document.getElementById('hint-btn');

            // 1. Kilitle
            document.body.style.pointerEvents = 'none';
            hintBtn.style.visibility = 'hidden'; 

            // 2. Ä°LK KONUMU KAYDET
            const positions = new Map();
            allCards.forEach(card => {
                const rect = card.getBoundingClientRect();
                positions.set(card.id, { left: rect.left, top: rect.top });
            });

            // 3. DOM DEÄÄ°ÅÄ°KLÄ°ÄÄ° (IÅŸÄ±nlama)
            correctSentenceStr.split(' ').forEach((_, i) => {
                const card = document.getElementById(`word-obj-${i}`);
                dropZone.appendChild(card); 
            });

            // 4. HESAPLA VE TERSÄ°NE Ã‡EVÄ°R
            allCards.forEach(card => {
                const oldPos = positions.get(card.id);
                const newRect = card.getBoundingClientRect(); 

                const deltaX = oldPos.left - newRect.left;
                const deltaY = oldPos.top - newRect.top;

                card.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
                card.style.transition = 'none'; 
            });

            // 5. OYNAT (Play)
            requestAnimationFrame(() => {
                allCards.forEach(card => {
                    card.style.transition = 'transform 2.5s cubic-bezier(0.25, 1, 0.5, 1)';
                    card.style.transform = 'translate(0, 0)';
                    card.style.zIndex = '100'; 
                });
            });

            // 6. BÄ°TÄ°R VE KONTROL ET
            setTimeout(() => {
                allCards.forEach(card => {
                    card.style.transition = '';
                    card.style.transform = '';
                    card.style.zIndex = '';
                });
                
                document.body.style.pointerEvents = 'auto';
                checkScrambleAnswer([correctSentenceStr]);
            }, 2500); 
        }

        // --- Sonraki Etkinlik ---
        function nextActivity() {
            currentActivityIndex++; 
            if (currentActivityIndex === grandTotalActivities) {
                showFinishScreen();
            } else {
                loadActivity();
            }
        }

        // --- BitiÅŸ EkranÄ± ---
        function showFinishScreen() {
            activityArea.innerHTML = `
                <div id="finish-screen">
                    <p>Ø£ÙØ­Ù’Ø³ÙÙ†Ù’Øª! Ù„ÙÙ‚ÙØ¯ Ø£ÙÙƒÙ’Ù…ÙÙ„Ù’ØªÙ Ø¬ÙÙ…ÙŠØ¹ Ø§Ù„Ø£ÙÙ†Ù’Ø´ÙØ·ÙØ©â€«.â€¬</p>
                    <div class="score-display">
                        <span class="score-item score-correct">âœ” ${scoreCorrect}</span>
                        <span class="score-item score-incorrect">âŒ ${scoreIncorrect}</span>
                    </div>
                    <button id="replay-button" onclick="restartGame()">ğŸ”„</button>
                </div>
            `;
            instructionText.textContent = "Ø§ÙÙ†Ù’ØªÙÙ‡ÙØª Ø§Ù„Ø£ÙÙ†Ù’Ø´ÙØ·ÙØ©";
            progressDisplay.textContent = "Ø§ÙÙƒÙ’ØªÙÙ…ÙÙ„";
            progressBar.style.width = '100%';
            progressBar.style.backgroundColor = 'var(--success-color)';
        }
        
        // --- Yeniden BaÅŸlat ---
        function restartGame() {
            playSound('touch');
            scoreCorrect = 0;
            scoreIncorrect = 0;
            currentActivityIndex = 0; 
            currentTour++; 
            
            progressBar.style.width = '0%';
            progressBar.style.backgroundColor = 'var(--accent-color)';
            
            createActivityQueue(); 
            loadActivity(); 
        }
        // --- BaÅŸlangÄ±Ã§ Fonksiyonu ---
function startGame() {
    // 1. EkranÄ± Tam Ekran Moduna GeÃ§ir
    toggleFullScreen();
    
    // 2. BaÅŸlangÄ±Ã§ ekranÄ±nÄ± gizle (ArtÄ±k aktivite alanÄ± iÃ§indeki tek Ã¶ÄŸe gizlenecek)
    const startScreen = document.getElementById('start-screen');
    if (startScreen) startScreen.style.display = 'none';

    // 3. Etkinlikleri yÃ¼kle
    createActivityQueue(); 
    loadActivity();
}

// toggleFullScreen fonksiyonu zaten mevcuttur, sadece referans:
// function toggleFullScreen() { ... }

        // --- Ä°lerleme GÃ¼ncelleme ---
        function updateProgress() {
            if (grandTotalActivities === 0) { progressDisplay.textContent = `0 / 10`; return; }
            if (currentActivityIndex === grandTotalActivities) return; 
            const currentQuestionNum = currentActivityIndex + 1;
            const progressPercent = (currentActivityIndex / grandTotalActivities) * 100;
            progressDisplay.textContent = `${currentQuestionNum} / ${grandTotalActivities}`;
            progressBar.style.width = `${progressPercent}%`;
        }
        
        // --- SÃ¼rÃ¼kle-BÄ±rak OlaylarÄ± ---
        function addDragDropListeners() {
            const draggables = document.querySelectorAll('.word-item');
            const containers = [document.getElementById('drop-zone'), document.getElementById('drag-zone')];

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    if (!e.currentTarget.draggable) { e.preventDefault(); return; }
                    e.currentTarget.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', e.currentTarget.id);
                });
                draggable.addEventListener('dragend', (e) => { e.currentTarget.classList.remove('dragging'); });
            });

            containers.forEach(container => {
                container.addEventListener('dragover', (e) => { e.preventDefault(); });
                
                container.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const draggable = document.getElementById(id);
                    if (draggable && draggable.draggable) { 
                        container.appendChild(draggable);
                        draggable.classList.remove('dragging');
                        
                        updateButtonState();
                    }
                });
            });
        }
        
        // --- BAÅLANGIÃ‡ YÃ–NETÄ°MÄ° (GÃœNCELLENMÄ°Å HALÄ°) ---
document.addEventListener('DOMContentLoaded', () => {
    // Verileri temizle
    activitiesData.forEach(round => {
        round.w = round.w.map(word => word.trim().replace(/\.$/, ''));
        round.s = round.s.map(s_item => s_item.trim().replace(/\.$/, ''));
    });
    
    // Mevcut Tam Ekran dinleyicileri
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    if (fullscreenBtn) fullscreenBtn.addEventListener('click', toggleFullScreen);
    document.addEventListener('fullscreenchange', () => {
        if (document.fullscreenElement) document.body.classList.add('fullscreen');
        else document.body.classList.remove('fullscreen');
    });
    
    // KuyruÄŸu oluÅŸtur ama oyunu henÃ¼z BAÅLATMA (loadActivity Ã§aÄŸrÄ±lmadÄ±)
    createActivityQueue(); 
    
    // "BAÅLA" BUTONU MANTIÄI:
    const startBtn = document.getElementById('start-button');
if(startBtn) {
    startBtn.addEventListener('click', () => {
        // 1. Gizli olan Ãœst Bar'Ä± (Header) aÃ§
        const header = document.getElementById('game-header');
        if (header) header.style.display = 'grid'; 

        // 2. Tam Ekran yap
        toggleFullScreen();
        
        // 3. Oyun ses motorunu baÅŸlat (TarayÄ±cÄ± izni iÃ§in hemen tetiklenmeli)
        initAudioContext();
        
        // 4. Oyunu sahneye yÃ¼kle (GÃ¶rÃ¼ntÃ¼ hemen gelsin)
        loadActivity();

        // 5. YÃ¶nerge sesini 500ms (YarÄ±m Saniye) GECÄ°KMELÄ° Ã§al
        setTimeout(() => {
            const introAudio = document.getElementById('intro-sound');
            if(introAudio) {
                introAudio.play().catch(e => console.log("Ses hatasÄ±:", e));
            }
        }, 600); 
    });

    }
});
    </script> 
    <script src="https://cdn.jsdelivr.net/npm/drag-drop-touch@1.3.1/DragDropTouch.js"></script>
</body>
</html>