<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†ÙØ´Ø§Ø·: Ø§Ù„ÙˆÙØ­Ù’Ø¯ÙØ© Ø§Ù„Ø«Ù‘Ø§Ù†ÙÙŠÙØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        @font-face {
        font-family: 'Arakom';
        src: url('ARAKOM.TTF') format('truetype'),
             url('arakom.ttf') format('truetype'),
             url('Arakom.ttf') format('truetype');
        font-weight: normal;
        font-style: normal;
    }

        /* --- Temel Sayfa Stilleri --- */
        :root {
            --accent-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #f8f9fa;
            
            /* GÃœNCELLEME: Font 'Arakom' olarak deÄŸiÅŸtirildi */
            --font-arabic: 'Arakom', 'Markazi Text', 'Tahoma', 'Arial', sans-serif;
        }
        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            font-weight: 400;
        }

        /* --- Ana Etkinlik AlanÄ± (16:9) --- */
        .activity-container {
            position: relative;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: none; /* BaÅŸlangÄ±Ã§ta gizli */
            flex-direction: column;
            
            /* DEÄÄ°ÅÄ°KLÄ°K BURADA: %90 yerine %99 yapÄ±ldÄ± */
            width: 99vw;
            height: calc(99vw * 9 / 16); 
            max-height: 99vh;
            max-width: calc(99vh * 16 / 9);
        }
        
        /* --- Geri TuÅŸu --- */
        .back-button-container {
            grid-area: back;
            display: flex;
            justify-content: flex-end; 
            align-items: center; 
        }
        .back-button {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0; 
        }
        .back-button:hover {
            background: #e0e0e0;
        }
        .back-button svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }

        /* --- BaÅŸlÄ±k --- */
        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "instruction back"; 
            grid-template-columns: 1fr auto; 
            align-items: center;
            gap: 20px;
            flex-shrink: 0; 
        }
        
        #instruction-text {
            grid-area: instruction;
            text-align: right; 
            font-size: 2.2rem; 
            font-weight: 700;
            color: #555;
        }
        
        /* --- AsÄ±l Etkinlik AlanÄ± --- */
        .activity-area {
            flex-grow: 1;
            padding: 15px;
            display: flex;
            flex-direction: column; /* Ä°Ã§eriÄŸi ve butonu dikey hizalamak iÃ§in */
            justify-content: space-between; /* Ä°Ã§erik ve buton arasÄ±na boÅŸluk koymak iÃ§in */
            align-items: center;     
            overflow: hidden; 
        }

        /* --- SÄ±nÄ±flandÄ±rma Konteyneri --- */
        .categorize-container {
            display: flex;
            flex-direction: row-reverse; /* SaÄŸda kelimeler, solda kutular */
            width: 100%;  
            flex-grow: 1; /* TÃ¼m alanÄ± kapla */
            gap: 15px;
        }


        /* --- Sol Taraf (Hedef Kutular - GENÄ°ÅLETÄ°LDÄ°) --- */
        .drop-zones-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2 SÃ¼tun */
            gap: 15px;
            flex: 1; 
            overflow-y: auto; 
            padding: 5px;
        }

        .category-drop-zone {
            background-color: var(--bg-light);
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            padding: 10px;
            min-height: 150px;
            
            display: grid;
            grid-template-columns: 1fr 1fr; 
            grid-auto-rows: min-content;
            
            gap: 8px; 
            
            align-content: start;
            justify-items: center;
            transition: border-color 0.3s; /* Dragover iÃ§in ekledik */
        }

        .category-drop-zone h3 {
            grid-column: 1 / -1; 
            margin: 0 0 10px 0;
            font-size: 2.1rem; 
            color: var(--accent-color);
            border-bottom: 2px solid #ddd;
            padding-bottom: 5px;
            width: 100%;
            text-align: center;
        }
        /* --- Tek kalan son kutuyu ortalama kodu --- */
        .drop-zones-container .category-drop-zone:last-child:nth-child(odd) {
            grid-column: span 2;      
            justify-self: center;     
            width: calc(50% - 7.5px); 
        }
        
        /* --- SaÄŸ Taraf (Kelime BankasÄ± - DARALTILDI & 3 SÃœTUN) --- */
        .word-bank-container {
            flex: 0 0 30%; 
            height: 100%; 
            background: #fff;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 10px; 
            
            /* CSS GRID: 2 SÃœTUN */
            display: grid;
            grid-template-columns: repeat(2, 1fr); 
            align-content: start; 
            gap: 8px; 
            
            overflow-y: auto; 
            box-sizing: border-box;
        }

        .word-item {
            padding: 5px 2px;
            color: white;
            font-size: 1.8rem; 
            font-weight: 700;
            border-radius: 8px; 
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            
            width: 100%; 
            height: auto;
            min-height: 50px; 
            
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            line-height: 1.1;
        }
        
        .word-item:hover {
            filter: brightness(85%);
        }
        
        .word-item.mouse-dragging {
            opacity: 0.5;
            box-shadow: none;
        }
        
        /* --- KONTROL SONRASI STÄ°LLER --- */
        .word-item.correct {
            cursor: default;             /* Sadece fare imlecini deÄŸiÅŸtir */
            box-shadow: none !important; /* Ã‡erÃ§eve veya gÃ¶lge ekleme */
            filter: none !important;     /* ParlaklÄ±k deÄŸiÅŸikliÄŸi yapma */
            
            /* NOT: background-color satÄ±rÄ±nÄ± sildiÄŸimiz iÃ§in 
               kelime kendi orijinal renginde kalmaya devam eder. */
        }
        
        .word-item.incorrect {
            background-color: var(--danger-color) !important;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        /* --- Geri Bildirim --- */
        .feedback-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15rem;
            z-index: 200;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
            flex-direction: column; 
        }
        .feedback-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        .feedback-overlay .correct { color: var(--success-color); }
        .feedback-overlay .incorrect { color: var(--danger-color); }
        
        #replay-button {
            display: none; 
            font-size: 4.5rem; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
            margin-top: 20px; 
        }
        #replay-button:hover {
            transform: rotate(-90deg);
            background-color: #f0f0f0;
        }
        .feedback-overlay.show.game-finished #replay-button {
            display: block;
        }
        
        /* --- Tam Ekran Butonu --- */
        #fullscreen-btn {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px; 
            margin-left: 10px; 
            flex-shrink: 0; 
        }
        #fullscreen-btn:hover {
            background: #e0e0e0;
        }
        #fullscreen-btn svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }
        #fullscreen-btn .icon-open { display: block; }
        #fullscreen-btn .icon-close { display: none; }
        body.fullscreen #fullscreen-btn .icon-open { display: none; }
        body.fullscreen #fullscreen-btn .icon-close { display: block; }

        body.fullscreen .activity-container {
            position: fixed !important; /* Sayfa akÄ±ÅŸÄ±ndan Ã§Ä±kar, ekrana Ã§ivile */
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            
            /* SÄ±nÄ±rlamalarÄ± kaldÄ±r */
            max-width: none !important;
            max-height: none !important;
            margin: 0 !important;
            padding: 0 !important;
            border-radius: 0 !important;
            border: none !important;
            box-shadow: none !important;
            
            /* Ä°Ã§eriÄŸi dÃ¼zelt */
            display: flex !important;
            flex-direction: column !important;
            z-index: 99999 !important; /* En Ã¼ste Ã§Ä±kar */
        }

        /* Tam ekranda arka plan rengini beyaza eÅŸitle ki boÅŸluk hissi oluÅŸmasÄ±n */
        body.fullscreen {
            background-color: #ffffff !important; 
            overflow: hidden !important; /* KaydÄ±rma Ã§ubuklarÄ±nÄ± yok et */
            padding: 0 !important;
            margin: 0 !important;
            display: block !important; /* Flex ortalamasÄ±nÄ± iptal et */
        }

        /* --- Mobil Dikey DÃ¼zen (Portrait) --- */
        @media (orientation: portrait) {
            .activity-container {
                /* DEÄÄ°ÅÄ°KLÄ°K BURADA: %95 yerine %99 yapÄ±ldÄ± */
                width: 99vw;
                height: calc(99vw * 16 / 9); 
                max-height: 99vh;
                max-width: calc(99vh * 9 / 16); 
            }
            #start-screen h1 {
                font-size: 3rem; 
                margin-bottom: 5px;
            }

            #start-screen p {
                font-size: 1.5rem !important; 
            }

            #start-button-main {
                font-size: 2rem;    
                padding: 8px 40px;  
                margin-top: 20px;
                width: 60%;         
                max-width: 300px;
            }
            body.fullscreen .activity-container {
                width: 100vw;
                height: calc(100vw * 16 / 9);
                max-height: 100vh;
                max-width: calc(100vh * 9 / 16);
            }
            .header {
                padding: 10px 15px;
            }
            #instruction-text {
                font-size: 1.4rem; 
            }
            .categorize-container {
                flex-direction: column;
            }
            .drop-zones-container {
                width: 100%;
                flex: 1; 
            }
            .word-bank-container {
                 width: 100%; 
                 height: auto;
                 flex: 0 0 auto; 
                 max-height: 200px; 
                 grid-template-columns: repeat(3, 1fr);
            }
           .word-item {
                font-size: 1.3rem; 
                min-height: 40px;  
                width: 100%;
            }
             #check-button {
                font-size: 1.8rem !important;
                padding: 5px 20px !important;
            }
        }

        /* ================================================================= */
        /* --- GÃœNCELLENMÄ°Å: MOBÄ°L YATAY (LANDSCAPE) AYARLARI --- */
        /* ================================================================= */
        @media screen and (orientation: landscape) and (max-height: 500px) {
            
            html {
                font-size: 10px !important; 
            }

            .activity-container {
                width: 100vw !important;
                height: 100vh !important;
                max-width: none !important;
                max-height: none !important;
                border-radius: 0;
                box-shadow: none;
            }

            .header {
                padding: 2px 15px; 
                height: 40px; 
            }
            
            #instruction-text {
                font-size: 1.8rem;
                margin: 0;
            }

            .activity-area {
                padding: 5px;
            }

            .categorize-container {
                gap: 10px; 
            }

            /* --- Sol Taraf (Kutular) --- */
            .drop-zones-container {
                gap: 10px 10px; 
                padding: 10;
            }

            .category-drop-zone {
        /* Ä°ÅTE BOYUTU BELÄ°RLEYEN KISIM BURASI */
        height: 120px !important; 
        min-height: 100px !important;
        max-height: 250px !important;
        
        padding: 8px 4px 4px 4px !important;
        gap: 10px 10px !important;
        
        display: grid;
        grid-template-columns: repeat(3, 1fr) !important; /* 3 SÃ¼tun */
        grid-auto-rows: 32px; /* Her kelime 32px */
        
        overflow-y: auto; 
        align-content: start;
    }

           .category-drop-zone h3 {
    font-size: 2rem; 
    margin-bottom: 0;   /* BaÅŸlÄ±ÄŸÄ±n dÄ±ÅŸÄ±ndaki alt boÅŸluÄŸu sÄ±fÄ±rladÄ±k */
    padding-bottom: 0; /* Ã‡Ä°ZGÄ° Ä°LE YAZI ARASINDAKÄ° BOÅLUK BURASIDIR */
    border-bottom: 1px solid #ddd; /* Alt Ã§izgi */
    grid-column: 1 / -1; 
    
}
            /* --- SaÄŸ Taraf (Kelime BankasÄ±) --- */
            .word-bank-container {
                flex: 0 0 25%; 
                padding: 5px;
                gap: 6px;
                grid-template-columns: repeat(2, 1fr); 
            }

            .word-item {
                font-size: 1.4rem; 
                min-height: 28px;  
               padding: 1px 2px;
            }
            
            #check-button {
                font-size: 1.8rem !important;
                padding: 5px 20px !important;
            }

            .drop-zones-container, .word-bank-container {
                overflow-y: auto; 
            }
        }

        /* ========================================= */
        /* --- START SCREEN (Sadece ArapÃ§a) --- */
        /* ========================================= */
        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #007bff 0%, #0d6efd 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            text-align: center;
        }
        
        #start-screen h1 {
            font-size: 5rem;
            margin-bottom: 10px;
            text-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        #start-button-main {
            background: #ffc107;
            color: #333;
            font-family: var(--font-arabic);
            font-size: 3rem;
            font-weight: bold;
            padding: 10px 60px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 30px;
        }

        #start-button-main:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.3);
            background: #ffca2c;
        }

        /* ========================================= */
        /* --- ORIENTATION WARNING (Sadece ArapÃ§a) --- */
        /* ========================================= */
        #orientation-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #212529;
            color: white;
            display: none; 
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999; 
            text-align: center;
        }

        .phone-animation {
            width: 60px;
            height: 100px;
            border: 4px solid white;
            border-radius: 10px;
            margin-bottom: 20px;
            animation: rotate-phone 2s infinite ease-in-out;
        }

        @keyframes rotate-phone {
            0% { transform: rotate(0deg); }
            40% { transform: rotate(90deg); }
            100% { transform: rotate(90deg); }
        }

        #orientation-warning p {
            font-size: 2rem;
            font-family: var(--font-arabic);
            margin: 0;
        }

        @media screen and (orientation: portrait) and (max-width: 900px) {
            #orientation-warning {
                display: flex;
            }
            .activity-container, #start-screen {
                display: none !important;
            }
        }

/* --- SÃ¼rÃ¼klenme Animasyonu Ä°Ã§in --- */
.word-item.gliding {
    z-index: 1000; /* DiÄŸer her ÅŸeyin Ã¼stÃ¼nde gÃ¶rÃ¼nsÃ¼n */
    pointer-events: none; /* Hareket ederken tÄ±klanamasÄ±n */
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
}
/* Ä°Ã§eriÄŸin tam ekranda dikey olarak yayÄ±lmasÄ±nÄ± saÄŸlar */
        body.fullscreen .activity-area {
    </style>
    <script src="https://cdn.jsdelivr.net/npm/drag-drop-touch@1.3.1/DragDropTouch.js"></script>
</head>
<body>

    <div id="start-screen">
        
        
        <button id="start-button-main" onclick="startGame()">Ø§ÙØ¨Ù’Ø¯ÙØ£Ù’</button>
    </div>

    <div id="orientation-warning">
        <div class="phone-animation"></div>
        <p>ÙŠÙØ±Ù’Ø¬Ù‰ ØªÙØ¯Ù’ÙˆÙŠØ± Ø§Ù„Ø¬ÙÙ‡Ø§Ø²</p>
    </div>

    <div class="activity-container" id="game-container">
        
        <div class="header">
            <div id="instruction-text">...</div>
            <div class="back-button-container">
                <button id="fullscreen-btn">
                    <svg class="icon-open" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 10h2V7h3V5H5v5zM14 5v2h3v3h2V5h-5zM5 19v-5h2v3h3v2H5zM14 19v-2h3v-3h2v5h-5z"/>
                    </svg>
                    <svg class="icon-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
                    </svg>
                </button>
                <a href="index.html" class="back-button">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
    </svg>
</a>
            </div>
        </div>

        <div class="activity-area" id="activity-area">
            <div id="categorize-area-content" style="flex-grow: 1; width: 100%; display: flex; flex-direction: column;">
                </div>
            
            <div style="padding: 10px; border-top: 1px solid #ddd; width: 100%; display: flex; justify-content: center; flex-shrink: 0;">
                <button id="check-button" onclick="checkAllDrops()" style="
                    background-color: var(--accent-color); 
                    color: white; 
                    font-size: 2.5rem; 
                    padding: 8px 30px; 
                    border: none; 
                    border-radius: 8px; 
                    cursor: pointer; 
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    font-family: var(--font-arabic);
                    transition: background-color 0.2s;
                ">
                    ØªÙØ­ÙÙ‚Ù‘ÙÙ‚Ù’
                </button>
            </div>
        </div>

        <div class="feedback-overlay" id="feedback-overlay">
            <span id="feedback-icon"></span>
            <button id="replay-button" onclick="restartGame()">ğŸ”„</button>
        </div>

    </div>

<script>
        // --- 20 benzersiz renk ---
        const colorPalette = [
            '#007bff', '#dc3545', '#28a745', '#ffc107', '#17a2b8', '#6f42c1', '#fd7e14',
            '#20c997', '#6610f2', '#e83e8c', '#d63384', '#198754', '#0d6efd', '#adb5bd',
            '#ff6b6b', '#fca311', '#90be6d', '#43aa8b', '#577590', '#f94144'
        ];

        
         // --- Veri BankasÄ± (Tenvinli - Dammatan EklenmiÅŸ) ---
    const activityDataBank = [
        // 1. TUR: ZAMAN, GÃœNLÃœK FÄ°Ä°LLER VE Ã–ÄÃœNLER
        {
            title: "ØµÙÙ†ÙÙ‘Ù Ø§Ù„ÙƒÙÙ„ÙÙ…Ø§Øªâ€«.â€¬", 
            categories: ["Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª", "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª", "Ø§Ù„ÙˆÙØ¬ÙØ¨Ø§Øª"], // Zamanlar, GÃ¼nlÃ¼k Fiiller, Ã–ÄŸÃ¼nler
            words: [
                // Ø§Ù„Ø£ÙÙˆÙ’Ù‚Ø§Øª (Zamanlar / Vakitler)
                // Ø§Ù„Ø£ÙÙÙ’Ø¹Ø§Ù„ Ø§Ù„ÙŠÙÙˆÙ’Ù…ÙÙŠÙÙ‘Ø© (GÃ¼nlÃ¼k Rutin Fiilleri)
           
            { w: "Ù„ÙØ­Ù’Ù…", cat: "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª" },      // Et [cite: 597]
            { w: "Ø¯ÙØ¬Ø§Ø¬", cat: "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª" },     // Tavuk [cite: 597]
            { w: "Ø³ÙÙ…ÙÙƒ", cat: "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª" },      // BalÄ±k [cite: 597]
            { w: "Ø¨ÙÙŠÙ’Ø¶", cat: "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª" },      // Yumurta [cite: 533]
            { w: "Ø¬ÙØ¨Ù’Ù†", cat: "Ø§Ù„Ù…ÙØ£Ù’ÙƒÙˆÙ„Ø§Øª" },      // Peynir [cite: 516]

            // Ø§Ù„Ù…ÙØ´Ù’Ø±ÙÙˆØ¨Ø§Øª (Ä°Ã§ecekler)
            { w: "Ù…Ø§Ø¡", cat: "Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª" },       // Su [cite: 597]
            { w: "Ù‚ÙÙ‡Ù’ÙˆÙØ©", cat: "Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª" },    // Kahve [cite: 597]
            { w: "Ø­ÙÙ„ÙŠØ¨", cat: "Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª" },     // SÃ¼t [cite: 597]
            { w: "Ø¹ÙØµÙŠØ±", cat: "Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª" },     // Meyve Suyu [cite: 597]
            { w: "Ø´Ø§ÙŠ", cat: "Ø§Ù„Ù…ÙØ´Ù’Ø±ÙˆØ¨Ø§Øª" },       // Ã‡ay [cite: 522]

                // Ø§Ù„ÙˆÙØ¬ÙØ¨Ø§Øª (Ã–ÄŸÃ¼nler)
                { w: "ÙÙØ·ÙˆØ±", cat: "Ø§Ù„ÙˆÙØ¬ÙØ¨Ø§Øª" },           // KahvaltÄ±
                { w: "ØºÙØ¯Ø§Ø¡", cat: "Ø§Ù„ÙˆÙØ¬ÙØ¨Ø§Øª" },           // Ã–ÄŸle YemeÄŸi
                { w: "Ø¹ÙØ´Ø§Ø¡", cat: "Ø§Ù„ÙˆÙØ¬ÙØ¨Ø§Øª" }           // AkÅŸam YemeÄŸi
                
            ]
        },

        // 2. TUR: ULAÅIM, ZARFLAR VE OKUL HAYATI
        {
            title: "ØµÙÙ†ÙÙ‘Ù Ø§Ù„ÙƒÙÙ„ÙÙ…Ø§Øªâ€«.â€¬", 
            categories: ["Ø§Ù„Ø£ÙØ±Ù’Ù‚Ø§Ù…", "Ø§Ù„Ø¹ÙØ¨Ø§Ø¯Ø§Øª", "ØªÙÙƒÙ’Ø±Ø§Ø±"], // UlaÅŸÄ±m, Zarflar, Okul HayatÄ±
            words: [
                // Ø§Ù„Ù…ÙÙˆÙØ§ØµÙÙ„Ø§Øª (UlaÅŸÄ±m AraÃ§larÄ±)
                { w: "ÙˆÙØ¶ÙˆØ¡", cat: "Ø§Ù„Ø¹ÙØ¨Ø§Ø¯Ø§Øª" },           // Abdest
                { w: "ØµÙÙ„Ø§Ø©", cat: "Ø§Ù„Ø¹ÙØ¨Ø§Ø¯Ø§Øª" },           // Namaz
                { w: "ØªÙÙ„Ø§ÙˆÙØ© Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù†", cat: "Ø§Ù„Ø¹ÙØ¨Ø§Ø¯Ø§Øª" },           // Kuran
                { w: "Ø¯ÙØ¹Ø§Ø¡", cat: "Ø§Ù„Ø¹ÙØ¨Ø§Ø¯Ø§Øª" },

                // Ø§Ù„Ø¸ÙÙ‘Ø±ÙÙˆÙ (Zaman ZarflarÄ± / Durumlar)
                { w: "Ø§Ù„ÙˆØ§Ø­ÙØ¯ÙØ©", cat: "Ø§Ù„Ø£ÙØ±Ù’Ù‚Ø§Ù…" },          // Bir (Saat 1)
                { w: "Ø§Ù„Ø³Ù‘Ø§Ø¯ÙØ³ÙØ©", cat: "Ø§Ù„Ø£ÙØ±Ù’Ù‚Ø§Ù…" },         // AltÄ±
                { w: "Ø§Ù„Ø«Ù‘Ø§Ù†ÙÙŠÙØ© Ø¹ÙØ´ÙØ±ÙØ©", cat: "Ø§Ù„Ø£ÙØ±Ù’Ù‚Ø§Ù…" }, // On iki
                { w: "Ø§Ù„ØªÙ‘Ø§Ø³ÙØ¹ÙØ©", cat: "Ø§Ù„Ø£ÙØ±Ù’Ù‚Ø§Ù…" },
                // Ø§Ù„Ø­ÙÙŠÙØ§Ø© Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙÙŠÙÙ‘Ø© (Okul HayatÄ± ile ilgili terimler)
// ØªÙÙƒÙ’Ø±Ø§Ø± (SÄ±klÄ±k ZarflarÄ±)
                { w: "Ø¯Ø§Ø¦ÙÙ…Ù‹Ø§", cat: "ØªÙÙƒÙ’Ø±Ø§Ø±" },             // Her zaman
                { w: "Ø£ÙØ­Ù’ÙŠØ§Ù†Ù‹Ø§", cat: "ØªÙÙƒÙ’Ø±Ø§Ø±" },           // Bazen
                { w: "ØºØ§Ù„ÙØ¨Ù‹Ø§", cat: "ØªÙÙƒÙ’Ø±Ø§Ø±" },             // Genellikle
                { w: "Ø£ÙØ¨ÙØ¯Ù‹Ø§", cat: "ØªÙÙƒÙ’Ø±Ø§Ø±" },              // Asla / HiÃ§
            ]
        }
    ];

        // --- Gerekli Elementler ---
        const instructionText = document.getElementById('instruction-text');
        const feedbackOverlay = document.getElementById('feedback-overlay');
        const feedbackIcon = document.getElementById('feedback-icon');
        const startScreen = document.getElementById('start-screen');
        const gameContainer = document.getElementById('game-container');
        
        let audioCtx = null;
        let currentActivityIndex = 0; 

        // --- SES FONKSÄ°YONLARI ---
        function initAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'sine';
            const now = audioCtx.currentTime;

            if (type === 'touch') {
                oscillator.frequency.setValueAtTime(200, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now); oscillator.stop(now + 0.1);
            } else if (type === 'correct') {
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now); oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') {
                oscillator.frequency.setValueAtTime(300, now);
                oscillator.frequency.linearRampToValueAtTime(150, now + 0.3);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.3);
                oscillator.start(now); oscillator.stop(now + 0.3);
            }
        }

        
        // --- OYUN BAÅLATMA ---
        function startGame() {
            initAudioContext();
            startScreen.style.display = 'none';
            gameContainer.style.display = 'flex';
            loadActivity();
            
            // Kontrol butonunu gizle (Otomatik kontrol yapacaÄŸÄ±z)
            document.getElementById('check-button').style.display = 'none'; 
            triggerFullscreen();

            // --- YENÄ° EKLENEN KISIM: 0.6 Saniye Gecikmeli Ses ---
            setTimeout(() => {
                const audio = new Audio('yonergebirak.wav');
                audio.play().catch(error => {
                    console.warn("Ses otomatik oynatÄ±lamadÄ± (TarayÄ±cÄ± engeli olabilir):", error);
                });
            }, 600); // 600 milisaniye = 0.6 saniye
        }

        function triggerFullscreen() {
            const docEl = document.documentElement;
            if(docEl.requestFullscreen) docEl.requestFullscreen().catch(err => {});
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadActivity() {
            const categorizeAreaContent = document.getElementById('categorize-area-content');
            categorizeAreaContent.innerHTML = '';
            
            const data = activityDataBank[currentActivityIndex];
            instructionText.textContent = data.title; 
            feedbackOverlay.classList.remove('show', 'game-finished');

            buildCategorize(data); 
        }
        
        function buildCategorize(data) {
            const container = document.createElement('div');
            container.className = 'categorize-container';

            const dropZonesContainer = document.createElement('div');
            dropZonesContainer.className = 'drop-zones-container';
            
            data.categories.forEach((categoryName) => {
                const dropZone = document.createElement('div');
                dropZone.className = 'category-drop-zone';
                dropZone.dataset.category = categoryName; 
                const title = document.createElement('h3');
                title.textContent = categoryName;
                dropZone.appendChild(title);
                dropZonesContainer.appendChild(dropZone);
            });
            
            const wordBank = document.createElement('div');
            wordBank.className = 'word-bank-container';
            wordBank.id = 'word-bank-container'; 
            
            const shuffledWords = shuffle([...data.words]);
            shuffledWords.forEach((wordData, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.id = `word-${index}`;
                wordItem.textContent = wordData.w;
                wordItem.dataset.wordCat = wordData.cat; 
                wordItem.draggable = true;
                wordItem.style.backgroundColor = colorPalette[index % colorPalette.length];
                wordBank.appendChild(wordItem);
            });
            
            container.appendChild(dropZonesContainer);
            container.appendChild(wordBank);
            document.getElementById('categorize-area-content').appendChild(container);
            
            addDragDropListeners();
        }

       
        // --- GELÄ°ÅMÄ°Å METÄ°N DÃ–NÃœÅTÃœRME (GÃœNCELLENDÄ°: FethalÄ± Elif) ---
        function transformWordText(wordElement, category) {
            let text = wordElement.textContent;
            
            // EÄŸer zaten "Ø§Ù„" ile baÅŸlÄ±yorsa iÅŸlem yapma
            if (text.startsWith("Ø§Ù„") || text.startsWith("Ø§ÙÙ„")) return;

            // 1. ADIM: Sondaki Tenvin'i (Dammatan - u064C) tek Ã–treye (Damma - u064F) Ã§evir
            text = text.replace(/\u064C$/, '\u064F'); 

            // 2. ADIM: Kategoriye gÃ¶re Elif-Lam ve Åedde/Cezim ekle
            if (category.includes("Ø§Ù„Ø´Ù‘ÙÙ…Ù’Ø³ÙÙŠÙ‘ÙØ©")) {
                // ÅEMSÄ°: "Ø§ÙÙ„" (Elif+Fetha+Lam) + Ä°lk Harf + Åedde + Kelimenin geri kalanÄ±
                // Lam okunmaz ama yazÄ±lÄ±r, Elif fethalÄ± olur.
                let firstChar = text.charAt(0);
                let restOfWord = text.slice(1);
                
                // Åedde unicode: \u0651
                // BURADA DEÄÄ°ÅÄ°KLÄ°K YAPILDI: "Ø§Ù„" yerine "Ø§ÙÙ„" (Elif Ã¼zerinde Fetha)
                wordElement.textContent = "Ø§ÙÙ„" + firstChar + "\u0651" + restOfWord;
            } else {
                // KAMERÄ°: "Ø§ÙÙ„Ù’" (Elif+Fetha + Lam+Cezim) + Kelime
                // Cezim unicode: \u0652
                // BURADA DEÄÄ°ÅÄ°KLÄ°K YAPILDI: "Ø§Ù„" yerine "Ø§ÙÙ„" (Elif Ã¼zerinde Fetha)
                wordElement.textContent = "Ø§ÙÙ„\u0652" + text;
            }
        }

        // --- SÃœRÃœKLE BIRAK MANTIÄI ---
        function addDragDropListeners() {
            const draggables = document.querySelectorAll('.word-item:not(.correct)'); 
            const containers = document.querySelectorAll('.category-drop-zone, .word-bank-container');

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    draggable.classList.add('mouse-dragging'); 
                    e.dataTransfer.setData('text/plain', draggable.id);
                    playSound('touch');
                });
                draggable.addEventListener('dragend', (e) => {
                    e.target.classList.remove('mouse-dragging');
                });
            });

            containers.forEach(container => {
                container.addEventListener('dragover', e => {
                    e.preventDefault();
                    if(container.classList.contains('category-drop-zone')) {
                        container.style.border = '2px dashed #00b300';
                    }
                });
                
                container.addEventListener('dragleave', e => {
                    if(container.classList.contains('category-drop-zone')) {
                        container.style.border = '2px solid var(--accent-color)';
                    }
                });
                
                container.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const wordElement = document.getElementById(id);
                    const dropZone = e.target.closest('.category-drop-zone');

                    // Stil temizliÄŸi
                    if(dropZone) dropZone.style.border = '2px solid var(--accent-color)';

                    if (!wordElement) return;

                    // EÄŸer boÅŸluÄŸa deÄŸil de bir kutuya bÄ±rakÄ±ldÄ±ysa
                    if (dropZone) {
                        const zoneCategory = dropZone.dataset.category;
                        const wordCategory = wordElement.dataset.wordCat;

                        dropZone.appendChild(wordElement); // Ã–nce bÄ±rakÄ±lan yere koy

                        if (zoneCategory === wordCategory) {
                            // --- DOÄRU ---
                            handleSuccess(wordElement, zoneCategory);
                        } else {
                            // --- YANLIÅ ---
                            handleMistake(wordElement, dropZone, wordCategory);
                        }
                    } else if (e.target.closest('.word-bank-container')) {
                        // Bankaya geri bÄ±rakÄ±rsa
                        e.target.closest('.word-bank-container').appendChild(wordElement);
                    }
                });
            });
        }

// --- DOÄRU CEVAP Ä°ÅLEMÄ° ---
        function handleSuccess(wordElement, category) {
            playSound('correct');
            wordElement.classList.add('correct');
            wordElement.classList.remove('incorrect');
            wordElement.draggable = false;
            
            // Metin dÃ¶nÃ¼ÅŸtÃ¼rme kodu kaldÄ±rÄ±ldÄ±. Kelime olduÄŸu gibi kalacak.

            checkGameCompletion();
        }

        // --- YANLIÅ CEVAP VE OTOMATÄ°K DÃœZELTME (Animasyonlu) ---
        function handleMistake(wordElement, wrongZone, correctCategory) {
            playSound('incorrect');
            wordElement.classList.add('incorrect'); // KÄ±rmÄ±zÄ± ve titreme
            
            // 1. Titreme sÃ¼resince bekle (0.5 saniye)
            setTimeout(() => {
                // 2. DoÄŸru kutuyu bul
                const correctZone = [...document.querySelectorAll('.category-drop-zone')]
                    .find(zone => zone.dataset.category === correctCategory);
                
                if (correctZone) {
                    animateWordToZone(wordElement, correctZone, correctCategory);
                }
            }, 600);
        }

        // --- UÃ‡MA ANÄ°MASYONU (FLIP TekniÄŸi) ---
        function animateWordToZone(wordElement, targetZone, correctCategory) {
            // 1. Mevcut pozisyonu (YanlÄ±ÅŸ Kutu) kaydet
            const firstRect = wordElement.getBoundingClientRect();

            // 2. Elementi hedef kutuya (DOM olarak) taÅŸÄ± ama henÃ¼z gÃ¶rÃ¼nÃ¼mÃ¼ deÄŸiÅŸmesin
            targetZone.appendChild(wordElement);

            // 3. Hedef pozisyonu kaydet
            const lastRect = wordElement.getBoundingClientRect();

            // 4. Aradaki farkÄ± hesapla (Invert)
            const deltaX = firstRect.left - lastRect.left;
            const deltaY = firstRect.top - lastRect.top;

            // 5. Elementi gÃ¶rsel olarak eski yerine geri it (Transform ile)
            wordElement.style.transition = 'none';
            wordElement.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
            wordElement.classList.add('gliding'); // Z-index yÃ¼kselt
            wordElement.classList.remove('incorrect'); // KÄ±rmÄ±zÄ±lÄ±ÄŸÄ± kaldÄ±r (ya da tutabiliriz, tercih meselesi)

            // 6. TarayÄ±cÄ±ya deÄŸiÅŸikliÄŸi iÅŸlemesi iÃ§in zorla (Reflow)
            wordElement.offsetHeight;

            // 7. Animasyonu BaÅŸlat (Play): 0'a (yeni yerine) kaydÄ±r
            wordElement.style.transition = 'transform 1.0s ease-in-out'; // YavaÅŸÃ§a (1 saniye)
            wordElement.style.transform = `translate(0, 0)`;

            // 8. Animasyon bitince temizlik yap
            setTimeout(() => {
                wordElement.style.transition = '';
                wordElement.style.transform = '';
                wordElement.classList.remove('gliding');
                
                // ArtÄ±k doÄŸru yerde olduÄŸu iÃ§in baÅŸarÄ± fonksiyonunu Ã§aÄŸÄ±r
                handleSuccess(wordElement, correctCategory);
            }, 1000); // Transition sÃ¼resi kadar bekle
        }

        // --- OYUN BÄ°TÄ°Å KONTROLÃœ ---
        function checkGameCompletion() {
            const totalWordsCount = document.querySelectorAll('.word-item').length;
            const correctWordsCount = document.querySelectorAll('.word-item.correct').length;
            
            if (correctWordsCount === totalWordsCount && totalWordsCount > 0) {
                instructionText.textContent = "Ø£ÙØ­Ù’Ø³ÙÙ†Ù’Øª! Ù„ÙÙ‚ÙØ¯ Ø£ÙÙƒÙ’Ù…ÙÙ„Ù’ØªÙ";
                feedbackOverlay.classList.add('game-finished');
                
                currentActivityIndex++;
                if (currentActivityIndex >= activityDataBank.length) currentActivityIndex = 0; 
                
                setTimeout(() => {
                    feedbackIcon.textContent = 'âœ”';
                    feedbackIcon.className = 'correct';
                    feedbackOverlay.classList.add('show');
                }, 500); // Son kelime yerine oturduktan biraz sonra gÃ¶ster
            }
        }
        
        function restartGame() {
            playSound('touch');
            feedbackOverlay.classList.remove('show', 'game-finished'); 
            loadActivity(); 
        }

        function setupFullscreen() {
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            if (!fullscreenBtn) return;
            fullscreenBtn.addEventListener('click', () => {
                const docEl = document.documentElement;
                if(!document.fullscreenElement) {
                    if(docEl.requestFullscreen) docEl.requestFullscreen();
                } else {
                    if(document.exitFullscreen) document.exitFullscreen();
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            setupFullscreen(); 
        });

    </script>
</body>
</html>